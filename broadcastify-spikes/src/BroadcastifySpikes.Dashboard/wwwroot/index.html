<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Broadcastify Spikes</title>
    <link rel="stylesheet" href="site.css" />
</head>
<body>
    <header class="topbar">
        <div class="brand">
            <div class="logo">BS</div>
            <div>
                <div class="title">Broadcastify Spikes</div>
                <div class="subtitle">Ingest • Detect • Alert</div>
            </div>
        </div>

        <div class="status">
            <div class="chip" id="healthChip">Checking…</div>
            <div class="chip chip-muted" id="lastRefresh">—</div>
        </div>
    </header>

    <main class="wrap">
        <section class="cards">
            <div class="card">
                <div class="card-title">Latest Run</div>
                <div class="metric" id="latestRunMetric">—</div>
                <div class="hint" id="latestRunHint">—</div>
            </div>

            <div class="card">
                <div class="card-title">Recent Samples</div>
                <div class="metric" id="samplesMetric">—</div>
                <div class="hint">Newest rows across all feeds</div>
            </div>

            <div class="card">
                <div class="card-title">Alert History</div>
                <div class="metric" id="alertsMetric">—</div>
                <div class="hint">Spike + feed_seen alerts</div>
            </div>
        </section>
        <section class="panel panel-split">
            <div class="panel-left">
                <div class="tabs">
                    <button class="tab active" data-tab="run">Latest Run</button>
                    <button class="tab" data-tab="samples">Recent Samples</button>
                    <button class="tab" data-tab="alerts">Alert History</button>
                    <div class="tab-spacer"></div>
                    <input id="search" class="search" placeholder="Filter rows (name / id / listeners / type)…" />
                    <button id="refresh" class="btn">Refresh</button>
                </div>

                <div class="tabbody active" id="tab-run">
                    <div class="tablewrap">
                        <table class="grid" id="runTable">
                            <thead>
                                <tr>
                                    <th style="width:170px;">Time (UTC)</th>
                                    <th style="width:720px;">Feed</th>
                                    <th style="width:120px;">Feed ID</th>
                                    <th style="width:720px;">Listeners</th>
                                    <th style="width:80px;">Rank</th>
                                    <th style="width:90px;">Link</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div class="empty" id="runEmpty" hidden>No ingest runs recorded yet.</div>
                </div>

                <div class="tabbody" id="tab-samples">
                    <div class="tablewrap">
                        <table class="grid" id="samplesTable">
                            <thead>
                                <tr>
                                    <th style="width:170px;">Time (UTC)</th>
                                    <th style="width:720px;">Feed</th>
                                    <th style="width:120px;">Feed ID</th>
                                    <th style="width:120px;">Listeners</th>
                                    <th style="width:80px;">Rank</th>
                                    <th style="width:90px;">Link</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>

                <div class="tabbody" id="tab-alerts">
                    <div class="tablewrap">
                        <table class="grid" id="alertsTable">
                            <thead>
                                <tr>
                                    <th style="width:170px;">Time (UTC)</th>
                                    <th style="width:720px;">Feed</th>
                                    <th style="width:120px;">Feed ID</th>
                                    <th style="width:130px;">Type</th>
                                    <th style="width:720px;">Message</th>
                                    <th style="width:90px;">Link</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <aside class="panel-right" id="inspector">
                <div class="inspector-header">
                    <div>
                        <div class="inspector-title">Stream Inspector</div>
                        <div class="inspector-subtitle" id="inspectorSubtitle">Click any row to inspect that feed.</div>
                    </div>
                    <button class="btn btn-muted" id="inspectorClear">Clear</button>
                </div>

                <div class="inspector-section">
                    <div class="inspector-kv">
                        <div class="kv">
                            <div class="kv-label">Feed</div>
                            <div class="kv-value" id="inspFeedName">—</div>
                        </div>
                        <div class="kv">
                            <div class="kv-label">Feed ID</div>
                            <div class="kv-value" id="inspFeedId">—</div>
                        </div>
                        <div class="kv">
                            <div class="kv-label">Selected Time (UTC)</div>
                            <div class="kv-value" id="inspSelectedTime">—</div>
                        </div>
                        <div class="kv">
                            <div class="kv-label">Selected Listeners</div>
                            <div class="kv-value" id="inspSelectedListeners">—</div>
                        </div>
                    </div>

                    <div class="inspector-section-title">Stats</div>
                    <div class="stats-grid">
                        <div class="stat">
                            <div class="stat-label">Feed Mean</div>
                            <div class="stat-value" id="statFeedMean">—</div>
                        </div>
                        <div class="stat">
                            <div class="stat-label">Feed Std Dev</div>
                            <div class="stat-value" id="statFeedStd">—</div>
                        </div>
                        <div class="stat">
                            <div class="stat-label">Feed P95</div>
                            <div class="stat-value" id="statFeedP95">—</div>
                        </div>
                        <div class="stat">
                            <div class="stat-label">Spike Threshold</div>
                            <div class="stat-value" id="statThreshold">—</div>
                        </div>
                        <div class="stat">
                            <div class="stat-label">Global Mean</div>
                            <div class="stat-value" id="statGlobalMean">—</div>
                        </div>
                        <div class="stat">
                            <div class="stat-label">Global P95</div>
                            <div class="stat-value" id="statGlobalP95">—</div>
                        </div>
                    </div>

                    <div class="hint" id="statHint">—</div>

                    <div class="inspector-section-title">History (samples for this feed)</div>
                    <div class="tablewrap" style="max-height: 42vh;">
                        <table class="grid" id="inspHistoryTable">
                            <thead>
                                <tr>
                                    <th style="width:170px;">Time (UTC)</th>
                                    <th style="width:120px;">Listeners</th>
                                    <th style="width:80px;">Rank</th>
                                    <th style="width:90px;">Link</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>

                    <div class="empty" id="inspEmpty">No selection.</div>
                    <div class="empty" id="inspError" hidden></div>
                </div>
            </aside>
        </section>
    </main>

    <script src="site.js"></script>
</body>
</html>
